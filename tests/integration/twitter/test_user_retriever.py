import os
import unittest

from src.twitter.user import TwitterUser
from src.twitter.user_not_found import TwitterUserNotFound
from src.twitter.user_retriever import TwitterUsersRetriever


class TwitterDevelopersRetrieverTestCase(unittest.TestCase):
    def test_retrieves_connections_of_developers(self) -> None:
        user = TwitterUsersRetriever(
            api_token=os.environ["JAT_TWITTER_API_TOKEN"]
        ).user("PiotrKopalko")
        self.assertEqual(
            TwitterUser(
                "PiotrKopalko",
                follows=[
                    "Melania27035243",
                    "JKlikowicz",
                    "TomaszMielcarz",
                    "dbwolski",
                    "pawelglinski",
                    "FrontCnot",
                    "jakubwiech",
                    "MarkHertling",
                    "SMWarszawa",
                    "TadeuszGiczan",
                    "WorldBollard",
                    "mariamposts",
                    "michal_kolanko",
                    "Piechocinski",
                    "jmvasquez1974",
                    "Wprostbiznes",
                    "wolski_jaros",
                    "TKolesnychenko",
                    "Anon_Polska",
                    "BrisaaColoridaa",
                    "RCB_RP",
                    "PhillipsPOBrien",
                    "igorsushko",
                    "samagreene",
                    "sbreakintl",
                    "TrentTelenko",
                    "ThreshedThought",
                    "Peter_Nimitz",
                    "KofmanMichael",
                    "WarintheFuture",
                    "RealCynicalFox",
                    "kamilkazani",
                    "YourAnonOne",
                    "YourAnonNews",
                    "kasianaga",
                    "MKarnitschnig",
                    "ibimspl",
                    "snitstwits",
                    "WeryfikacjaNASK",
                    "Kasparov63",
                    "CztOrg",
                    "RynekKolejowy",
                    "z_biegiem_szyn",
                    "phdskat",
                    "mwpotocki",
                    "ZelenskyyUa",
                    "m_zdanowska",
                    "MartaWojcicka",
                    "molszew77",
                    "MartaMarczak_",
                    "AWasaznik",
                    "postulatyINFO",
                    "protestmedykow",
                    "wsurala",
                    "kamilagoldyka",
                    "Rabbi_de_Winter",
                    "A_Orzechowski",
                    "bethcodes",
                    "ZKierowca",
                    "bfialek",
                    "KAllerslev",
                    "GreenFieldCoder",
                    "majakstasko",
                    "djcarpigiani",
                    "markiewkatomasz",
                    "WitoldGlowacki",
                    "AOC",
                    "janpoplawski",
                    "TadeuszRudzki",
                    "barb_jed",
                    "marta_ewa_sz",
                    "MelaniaLuczak",
                    "jacekgrzeszak",
                    "JanBaran999",
                    "mmzawisza",
                    "BenLuczynski",
                    "mr_zvbr",
                    "Kongres_RM",
                    "m_aciek",
                    "Weyzu",
                    "ZygmuntowskiJ",
                    "__Lewica",
                    "krytyka",
                    "AgaBak",
                    "PNastawiony",
                    "TrnsprtPblczn",
                    "PanZolty",
                    "AM_Zukowska",
                    "taxposting",
                    "szacki",
                    "oko_press",
                    "TygodnikNIE",
                    "PanskaSkorka",
                    "RazemwWarszawie",
                    "mlodalewica_",
                    "Mlodzi_Razem",
                    "dgpopiolek",
                    "MagdaBiejat",
                    "KubaCzajkowski",
                    "PieszaMasa",
                    "SGardawski",
                    "MarekJozefiak",
                    "AgataKowalskaTT",
                    "ChlewickiMarcin",
                    "galopujacymajor",
                    "MiastoUrsynow",
                    "LukaszWizla",
                    "bronek89",
                    "jarek_osowski",
                    "MarekSzolc",
                    "f_sterczewski",
                    "pragmatists",
                    "partiarazem",
                    "filippskora",
                    "bellingcat",
                    "_dkarasiewicz",
                    "ZandbergRAZEM",
                    "trzaskowski_",
                    "GeePawHill",
                    "PNEUMADUSZA",
                    "davideyko",
                    "allenholub",
                    "JSadikKhan",
                    "jwojc",
                    "celia_lowenthal",
                    "chantal_horeis",
                    "MJN_Zoliborz",
                    "go_bartek",
                    "donald_PL_",
                    "J_Koscinska",
                    "_zboral",
                    "OskarSkoczenWWA",
                    "RKaznowska",
                    "ZDM_Warszawa",
                    "WiatrakWAWpl",
                    "kulturagniewu",
                    "mbenesz",
                    "Ochocianie",
                    "pawelprzewlocki",
                    "LeMarton_",
                    "RobertBiedron",
                    "JanMencwel",
                    "WKarpieszuk",
                    "MiastoJestNasze",
                    "JustynaGlusman",
                    "Lukasz_Najder",
                    "phil_ipp_fritz",
                    "Gladwell",
                    "konradhalas",
                    "ignacy",
                    "martinfowler",
                    "unclebobmartin",
                    "KentBeck",
                ],
                followed_by=[],
            ),
            user,
            repr(user),
        )

    def test_returns_no_such_user_on_not_found(self):
        with self.assertRaises(TwitterUserNotFound):
            _ = TwitterUsersRetriever(os.environ["JAT_TWITTER_API_TOKEN"]).user(
                username="usernameof55787"
            )
